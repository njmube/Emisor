package com.cubetech.facturador.emisor.domain.emisor;

import static org.junit.Assert.*;

import java.security.GeneralSecurityException;
import java.security.InvalidKeyException;
import java.security.SignatureException;
import java.security.cert.CertificateException;

import javax.crypto.BadPaddingException;

import org.junit.Test;

import com.cubetech.facturador.emisor.domain.common.Archivo;
import com.cubetech.facturador.emisor.domain.cuenta.ArchivoCuenta;
import com.cubetech.facturador.emisor.domain.cuenta.Certificado;

public class CertificadoTest {

	@Test
	public void asignaPublico() throws CertificateException {
		ArchivoCuenta publico = new ArchivoCuenta();
		publico.setContent(Archivo.toByteArray("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"));
		publico.setCorrelacion("1234");
		publico.setNombre("Certificado.cer");
		publico.setTipo("application/certificado");
		
		Certificado cer = new Certificado();
		
		cer.asignaPublico(publico);
		
	}
	
	@Test
	public void timbra() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		
		publico.setContent(Archivo.toByteArray("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"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		cer.setPrivado(privado);
		cer.setPublico(publico);
		cer.setPassword("CMC161114E10");
		
		cer.timbra(cer.cadenaVerificacion);
	}
	
	@Test(expected = BadPaddingException.class)
	public void timbraBadPaddingException() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		
		publico.setContent(Archivo.toByteArray("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"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		cer.setPrivado(privado);
		cer.setPublico(publico);
		cer.setPassword("CMC161114E1");
		
		cer.timbra(Certificado.cadenaVerificacion);
	}
	
	@Test(expected = InvalidKeyException.class)
	public void timbraInvalidKeyException() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		
		publico.setContent(Archivo.toByteArray("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"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		cer.setPrivado(privado);
		cer.setPublico(publico);
		
		cer.timbra(Certificado.cadenaVerificacion);
	}
	@Test
	public void verifica() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		byte[] timbrado = null;
		
		publico.setContent(Archivo.toByteArray("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"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		cer.setPrivado(privado);
		cer.setPublico(publico);
		cer.setPassword("CMC161114E10");
		
		timbrado = cer.timbra(Certificado.cadenaVerificacion);
		
		assertTrue("failure - should be true", cer.verifica(Certificado.cadenaVerificacion, timbrado));
		
	}
	
	@Test
	public void verificaFalse() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		byte[] timbrado = null;
		
		publico.setContent(Archivo.toByteArray("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"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		cer.setPrivado(privado);
		cer.setPublico(publico);
		cer.setPassword("CMC161114E10");
		
		timbrado = cer.timbra(Certificado.cadenaVerificacion);
		
		assertFalse("failure - should be true", cer.verifica(Certificado.cadenaVerificacion + "+", timbrado));
		
	}
	
	@Test(expected = SignatureException.class)
	public void verificaException() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		byte[] timbrado = null;
		
		publico.setContent(Archivo.toByteArray("MIIEYTCCA0mgAwIBAgIUMjAwMDEwMDAwMDAyMDAwMDE0MjgwDQYJKoZIhvcNAQEFBQAwggFcMRowGAYDVQQDDBFBLkMuIDIgZGUgcHJ1ZWJhczEvMC0GA1UECgwmU2VydmljaW8gZGUgQWRtaW5pc3RyYWNpw7NuIFRyaWJ1dGFyaWExODA2BgNVBAsML0FkbWluaXN0cmFjacOzbiBkZSBTZWd1cmlkYWQgZGUgbGEgSW5mb3JtYWNpw7NuMSkwJwYJKoZIhvcNAQkBFhphc2lzbmV0QHBydWViYXMuc2F0LmdvYi5teDEmMCQGA1UECQwdQXYuIEhpZGFsZ28gNzcsIENvbC4gR3VlcnJlcm8xDjAMBgNVBBEMBTA2MzAwMQswCQYDVQQGEwJNWDEZMBcGA1UECAwQRGlzdHJpdG8gRmVkZXJhbDESMBAGA1UEBwwJQ295b2Fjw6FuMTQwMgYJKoZIhvcNAQkCDCVSZXNwb25zYWJsZTogQXJhY2VsaSBHYW5kYXJhIEJhdXRpc3RhMB4XDTEzMDUwNzE2MDEyOVoXDTE3MDUwNzE2MDEyOVowgdsxKTAnBgNVBAMTIEFDQ0VNIFNFUlZJQ0lPUyBFTVBSRVNBUklBTEVTIFNDMSkwJwYDVQQpEyBBQ0NFTSBTRVJWSUNJT1MgRU1QUkVTQVJJQUxFUyBTQzEpMCcGA1UEChMgQUNDRU0gU0VSVklDSU9TIEVNUFJFU0FSSUFMRVMgU0MxJTAjBgNVBC0THEFBQTAxMDEwMUFBQSAvIEhFR1Q3NjEwMDM0UzIxHjAcBgNVBAUTFSAvIEhFR1Q3NjEwMDNNREZOU1IwODERMA8GA1UECxMIcHJvZHVjdG8wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAKS/beUVy6E3aODaNuLd2S3PXaQre0tGxmYTeUxa55x2t/7919ttgOpKF6hPF5KvlYh4ztqQqP4yEV+HjH7yy/2d/+e7t+J61jTrbdLqT3WD0+s5fCL6JOrF4hqy//EGdfvYftdGRNrZH+dAjWWml2S/hrN9aUxraS5qqO1b7btlAgMBAAGjHTAbMAwGA1UdEwEB/wQCMAAwCwYDVR0PBAQDAgbAMA0GCSqGSIb3DQEBBQUAA4IBAQACPXAWZX2DuKiZVv35RS1WFKgT2ubUO9C+byfZapV6ZzYNOiA4KmpkqHU/bkZHqKjR+R59hoYhVdn+ClUIliZf2ChHh8s0a0vBRNJ3IHfA1akWdzocYZLXjz3m0Er31BY+uS3qWUtPsONGVDyZL6IUBBUlFoecQhP9AO39er8zIbeU2b0MMBJxCt4vbDKFvT9i3V0Puoo+kmmkf15D2rBGR+drd8H8Yg8TDGFKf2zKmRsgT7nIeou6WpfYp570WIvLJQY+fsMp334D05Up5ykYSAxUGa30RdUzA4rxN5hT+W9whWVGD88TD33Nw55uNRUcRO3ZUVHmdWRG+GjhlfsD"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		cer.setPrivado(privado);
		cer.setPublico(publico);
		cer.setPassword("CMC161114E10");
		
		timbrado = cer.timbra(Certificado.cadenaVerificacion);
		
		assertFalse("failure - should be true", cer.verifica(Certificado.cadenaVerificacion + "+", timbrado));
		
	}
	
	@Test
	public void comprueba() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		
		publico.setContent(Archivo.toByteArray("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"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		cer.setPrivado(privado);
		cer.setPublico(publico);
		cer.setPassword("CMC161114E10");
		
		assertTrue("failure - should be true", cer.comprueba());
		
	}
	
	@Test(expected = InvalidKeyException.class)
	public void compruebaInvalidKeyExceptionPublico() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		
		publico.setContent(Archivo.toByteArray("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"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		cer.setPrivado(privado);
		//cer.setPublico(publico);
		cer.setPassword("CMC161114E10");
		
		assertTrue("failure - should be true", cer.comprueba());
		
	}
	
	@Test(expected = InvalidKeyException.class)
	public void compruebaInvalidKeyExceptionPrivado() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		
		publico.setContent(Archivo.toByteArray("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"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		//cer.setPrivado(privado);
		cer.setPublico(publico);
		cer.setPassword("CMC161114E10");
		
		assertTrue("failure - should be true", cer.comprueba());
		
	}
	
	@Test(expected = InvalidKeyException.class)
	public void compruebaInvalidKeyExceptionPass() throws GeneralSecurityException{
		ArchivoCuenta publico = new ArchivoCuenta();
		ArchivoCuenta privado = new ArchivoCuenta();
		Certificado cer = new Certificado();
		
		publico.setContent(Archivo.toByteArray("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"));
		privado.setContent(Archivo.toByteArray("MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIAgEAAoIBAQACAggAMBQGCCqGSIb3DQMHBAgwggS9AgEAMASCBMhmmi2054QNyuqIZ4FuaeycFStJ3cQ9/1YxuvsTzd+sBvrxLcmBkZvKcnXCEChUMCXQnCk7W1sJQe14Vd2OGeLlvh7A64k7Qw6i/KhQ7dDFEfhhA/LZtKtJM2B32/XklsMZRNuwT0B+B90zBCvZAEWV5P9Y1y095mh61QJBwKCFgcaS+t8cwGKknO1afOLft7ONI1uZoJYCeirkL17XqpGcep9zsdc9FZlE0ozyHwz1P2AmstPwqg9pzu3u/UKe7oWfK5/G5087hBVp8nw3e7p51PuHcrTT6JCa3XsG9wYYbgyDiOv+fqtjm6/vOUANJwWbHy+DPz+rQ15kX9V00ZSRakbdbKE2JHoo3AXIfVrB2ryTY8vLLqArYjZzBiPNqBpiErVMuTA2DURwq/Uanodahl/idRC8jEeKxhIypFEk3x6Iz1TWXFIUZ3wE0/KU06J48bAtiEUwZx4aGcCAAKdL4Q201P2OvkBBEqemdoM+rXZCL1e9f6egdmKFnO6Un27kSTxtm5ONNyQ4/cKvFRh7Bxsj5x8jj37+fKulXH6kcX0sk6VctP8uaeVJ5Bc/AFvOJyNSCjNGFhzr8mC/7C/Dpxk/e3YL0QT9tIU11yiCF1HtA+ULtF4KDFCTSEUlEHT9rnXL5eeNeGRtfc5cy9X8kcqbVmDCPav7w8ilPXwfpAJdLg3zcZgF6PhpnweR7o7V4k7uEvYPDBEsPIcaSIEsNL8Winnp+qwLmG2fEEZKfzHVgOg01RNhOSw6J02uIH4HVxnO2doLJk+mc/3GaD3OSl38hjTycghpwOQJPvL87D8bdFlRPktxK36m72/AdqJ3G/KMtCIZ59YIfDbHtqecC/083wlb29ZyEiAt2IfHMFHWj99olbcBbIG+FG90dgY/iyEnAJTNsUDiFoSunqB7GmSjj9ol/CaTIfWDh3gHMSPst0m4hJtpGLJaKA/ULyiMeT5NXnXm16nFhnFFkMrLYIxqWk8Jib4P/k4F7AW01DoHVEx4l11Tb4yGIVJX+qGfCdw57Zx/3N5SYok0Fj8MQXn721Mt/ev93dIY7CVa//0foTUKRtpieotj8xTkQDQXJmJc0yFcGnUEXqVP2Cqo2rO/Enr+4sGLb9wKS2f62VfpVYVd1bMsTpbraP7aU7nQaeDBhzTruPniFCGbq2KNg3SJn7SsyYXbQwTZwOCyEmb8pBoLasFD3c7y9aDPZ6AElpEzmJAMGyrh4amB8P28NTyDpohF7cXUyYgzL/okyMrqjpxv4c5qRZV0alNnM8j+ewk+iiRo4fXdwk/7l8lnhWdbSkXVcBRLbIOOgJZ9AufNWfL+6IGyC1/N9NeNlzZLGxaw/NRmPl+GG49Pk2wKZd9hNNGDSH0TKta8Id/DsATB77ZiwLDj/hOFpryHg4mgS8xrTjhhpXcypIXqsa2CX20BDx4MmEojEuB+j65Q0FBM7C9KALrpcdYJIHc9z+ahPlFLs6oR/w1mXCRAOUfkgyrgBxLGFJlVZw3MSYHlRlCyZwXXwYTMGXTqjJ8z/7lkEXRjW3SVtQ3EFUrVQ0gz3LikhkU+dbaO60w51ixbqtMLxKLzAGQiemN6uFe/DhrXJKkR6eSNv5Gw6hkt/6X51IPL59gCYmo="));
		
		cer.setPrivado(privado);
		cer.setPublico(publico);
		//cer.setPassword("CMC161114E10");
		
		assertTrue("failure - should be true", cer.comprueba());
		
	}
	
}
